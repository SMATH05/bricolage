{% extends 'base.html.twig' %}

{% block title %}Marketplace
{% endblock %}

{% block body %}
	<div class="container py-5">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<div>
				<h1 class="fw-bold mb-0">{{ 'Marketplace'|trans }}</h1>
				<p class="text-muted">{{ "Achetez et vendez vos outils et matériaux entre particuliers."|trans }}</p>
			</div>
			<a href="{{ path('app_marketplace_new') }}" class="btn btn-primary rounded-pill px-4 shadow-sm">
				<i class="fas fa-plus me-2"></i>
				{{ 'Vendre un article'|trans }}
			</a>
		</div>

		{# Search/Filter Bar could go here #}

		<div class="row g-4">
			{% for product in products %}
				<div class="col-6 col-md-4 col-lg-3">
					<a href="{{ path('app_marketplace_show', {id: product.id}) }}" class="text-decoration-none">
						<div class="card h-100 border-0 shadow-sm hover-shadow transition-all">
							<div class="position-relative" style="height: 200px; overflow: hidden; border-radius: 0.5rem 0.5rem 0 0;">
								{% if product.image %}
									<img src="{{ asset('uploads/products/' ~ product.image) }}" alt="{{ product.title }}" class="w-100 h-100 object-fit-cover">
								{% else %}
									<div class="w-100 h-100 bg-light d-flex align-items-center justify-content-center text-muted">
										<i class="fas fa-image fa-3x opacity-25"></i>
									</div>
								{% endif %}
							</div>
							<div class="card-body p-3">
								<h5 class="fw-bold text-dark mb-1">{{ product.price }}
									€</h5>
								<p class="card-text text-dark text-truncate mb-1">{{ product.title }}</p>
								<small class="text-muted d-block">{{ product.category|trans }}</small>
								<div class="d-flex align-items-center mt-2 pt-2 border-top">
									<small class="text-muted text-truncate" style="font-size: 0.8rem;">
										<i class="fas fa-map-marker-alt me-1"></i>
										{{ product.user.email }}
										{# Temporary, maybe use a location field or User Name #}
									</small>
								</div>
							</div>
						</div>
					</a>
				</div>
			{% else %}
				<div class="col-12 text-center py-5">
					<div class="mb-4">
						<i class="fas fa-store-slash fa-4x text-muted opacity-25"></i>
					</div>
					<h3>{{ "Aucun article en vente pour le moment."|trans }}</h3>
					<p class="text-muted">{{ "Soyez le premier à publier une annonce !"|trans }}</p>
					<a href="{{ path('app_marketplace_new') }}" class="btn btn-outline-primary rounded-pill mt-3">{{ "Commencer à vendre"|trans }}</a>
				</div>
			{% endfor %}
		</div>
	</div>

	<style>
		.hover-shadow:hover {
			transform: translateY(-2px);
			box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
		}
		.transition-all {
			transition: all 0.3s ease;
		}
		.object-fit-cover {
			object-fit: cover;
		}
	</style>
{% endblock %}
