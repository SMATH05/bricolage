{% extends 'base.html.twig' %}

{% block title %}
	{{ product.title }}
{% endblock %}

{% block body %}
	<div class="container py-5">
		<nav aria-label="breadcrumb" class="mb-4">
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a href="{{ path('app_marketplace') }}" class="text-decoration-none">{{ 'Marketplace'|trans }}</a>
				</li>
				<li class="breadcrumb-item active" aria-current="page">{{ product.title }}</li>
			</ol>
		</nav>

		<div class="row g-4 justify-content-center">
			<div class="col-md-7">
				<div class="card border-0 shadow-lg rounded-4 overflow-hidden">
					<div class="position-relative bg-light text-center" style="min-height: 400px; max-height: 500px;">
						{% if product.image %}
							<img src="{{ asset('uploads/products/' ~ product.image) }}" alt="{{ product.title }}" class="img-fluid" style="max-height: 500px; width: 100%; object-fit: contain;">
						{% else %}
							<div class="d-flex align-items-center justify-content-center h-100 py-5">
								<i class="fas fa-image fa-5x text-muted opacity-25 py-5"></i>
							</div>
						{% endif %}
					</div>
				</div>

				<div class="card border-0 shadow-sm rounded-4 mt-3">
					<div class="card-body p-4">
						<h4 class="fw-bold mb-3">{{ 'Description'|trans }}</h4>
						<p class="text-muted mb-0" style="white-space: pre-line;">{{ product.description }}</p>
					</div>
				</div>
			</div>

			<div class="col-md-4">
				<div class="card border-0 shadow-lg rounded-4 sticky-top" style="top: 20px; z-index: 1;">
					<div class="card-body p-4">
						<h2 class="fw-bold mb-1">{{ product.price }}
							€</h2>
						<h1 class="h4 mb-3">{{ product.title }}</h1>
						<span class="badge bg-light text-dark border mb-4">{{ product.category|trans }}</span>

						<hr class="my-4">

						<h5 class="fw-bold mb-3">{{ 'Vendeur'|trans }}</h5>
						<div class="d-flex align-items-center mb-4">
							<div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3 shadow-sm" style="width: 50px; height: 50px; font-size: 1.2rem;">
								{{ product.user.email|first|upper }}
							</div>
							<div>
								<h6 class="mb-0 fw-bold">{{ product.user.email }}</h6>
								{# Should use Name if available #}
								<small class="text-muted">{{ 'Membre depuis'|trans }}
									{{ product.user.id }}</small>
								{# Fake join date #}
							</div>
						</div>

						<div class="d-grid gap-2">
							<a href="{{ path('app_payment_checkout', {id: product.id}) }}" class="btn btn-success btn-lg rounded-pill shadow-sm">
								<i class="fas fa-shopping-cart me-2"></i>
								{{ 'Acheter maintenant'|trans }}
							</a>
							<a href="{{ path('app_chat_conversation', {id: product.user.id}) }}" class="btn btn-outline-primary btn-lg rounded-pill shadow-sm">
								<i class="fas fa-comments me-2"></i>
								{{ 'Contacter le vendeur'|trans }}
							</a>
							{# Optional: Add 'Share' button #}
						</div>

						<div class="mt-4 text-center">
							<small class="text-muted">
								<i class="fas fa-clock me-1"></i>
								{{ 'Publié le'|trans }}
								{{ product.createdAt|date('d/m/Y') }}
							</small>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
